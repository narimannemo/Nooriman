<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <!--<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">-->
    <link rel="stylesheet" href="css/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>
<h1 class="wwm">Walk With Nooriman!!</h1>
<table cellspacing="0" cellpadding="0">
    <tr>
        <td>
            <img src="css\icon\lampw.svg" id="g1_1" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g1_2" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g1_3" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g1_4" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g1_5" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g1_6" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g1_7" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g1_8" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g1_9" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g1_10" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g1_11" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g1_12" class="droppable lamp">
        </td>
    </tr>
    <tr>
        <td>
            <img src="css\icon\lampw.svg" id="g2_1" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g2_2" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g2_3" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g2_4" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g2_5" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g2_6" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g2_7" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g2_8" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g2_9" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g2_10" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g2_11" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g2_12" class="droppable lamp">
        </td>
    </tr>
    <tr>
        <td>
            <img src="css\icon\lampw.svg" id="g3_1" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g3_2" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g3_3" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g3_4" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g3_5" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g3_6" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g3_7" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g3_8" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g3_9" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g3_10" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g3_11" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g3_12" class="droppable lamp">
        </td>
    </tr>
    <tr>
        <td>
            <img src="css\icon\lampw.svg" id="g4_1" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g4_2" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g4_3" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g4_4" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g4_5" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g4_6" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g4_7" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g4_8" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g4_9" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g4_10" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g4_11" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g4_12" class="droppable lamp">
        </td>
    </tr>
    <tr>
        <td>
            <img src="css\icon\lampw.svg" id="g5_1" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g5_2" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g5_3" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g5_4" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g5_5" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g5_6" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g5_7" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g5_8" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g5_9" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g5_10" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g5_11" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g5_12" class="droppable lamp">
        </td>
    </tr>
    <tr>
        <td>
            <img src="css\icon\lampw.svg" id="g6_1" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g6_2" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g6_3" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g6_4" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g6_5" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g6_6" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g6_7" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g6_8" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g6_9" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g6_10" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g6_11" class="droppable lamp">
        </td>
        <td>
            <img src="css\icon\lampw.svg" id="g6_12" class="droppable lamp">
        </td>
    </tr>
</table>
<img src="css\icon\person-walkingg.svg" id="oskol">

<script>
    let currentDroppable = null;
    let currentDroppable1 = null;
    let currentDroppable2 = null;
    let currentDroppable3 = null;
    let currentDroppable4 = null;
    let currentDroppable5 = null;
    let currentDroppable6 = null;
    let currentDroppable7 = null;
    let currentDroppable8 = null;
    oskol.onmousedown = function(event) {

        let shiftX = event.clientX - oskol.getBoundingClientRect().left;
        let shiftY = event.clientY - oskol.getBoundingClientRect().top;

        oskol.style.position = 'absolute';
        oskol.style.zIndex = 1000;
        document.body.append(oskol);

        moveAt(event.pageX, event.pageY);

        function moveAt(pageX, pageY) {
            oskol.style.left = pageX - shiftX + 'px';
            oskol.style.top = pageY - shiftY + 'px';
        }

        function onMouseMove(event) {
            moveAt(event.pageX, event.pageY);

            oskol.hidden = true;
            let elemBelow = document.elementFromPoint(event.clientX, event.clientY);
            let elemUp = document.elementFromPoint(event.clientX, event.clientY - 45);
            let elemDown = document.elementFromPoint(event.clientX, event.clientY + 45);
            let elemRight = document.elementFromPoint(event.clientX +90, event.clientY);
            let elemLeft = document.elementFromPoint(event.clientX -90, event.clientY );
            let elemUR = document.elementFromPoint(event.clientX +90, event.clientY - 45);
            let elemUL = document.elementFromPoint(event.clientX -90, event.clientY - 45);
            let elemDR = document.elementFromPoint(event.clientX +90, event.clientY +45);
            let elemDL = document.elementFromPoint(event.clientX -90, event.clientY +45 );
            oskol.hidden = false;

            if (!elemBelow) return;
            if (!elemUp) return;
            if (!elemDown) return;
            if (!elemRight) return;
            if (!elemLeft) return;
            if (!elemUL) return;
            if (!elemUR) return;
            if (!elemDL) return;
            if (!elemDR) return;

            let droppableBelow = elemBelow.closest('.droppable');
            let droppableUp = elemUp.closest('.droppable');
            let droppableDown = elemDown.closest('.droppable');
            let droppableRight = elemRight.closest('.droppable');
            let droppableLeft = elemLeft.closest('.droppable');

            let droppableUL = elemUL.closest('.droppable');
            let droppableUR = elemUR.closest('.droppable');
            let droppableDR = elemDR.closest('.droppable');
            let droppableDL = elemDL.closest('.droppable');
            if (currentDroppable != droppableBelow) {
                if (currentDroppable) { 
                    leaveDroppable(currentDroppable);
                }
                currentDroppable = droppableBelow;
                if (currentDroppable) {
                    
                    enterDroppable(currentDroppable);
                }
            }
            if (currentDroppable5 != droppableUR) {
                if (currentDroppable5) { 
                    leaveDroppable(currentDroppable5);
                }
                currentDroppable5 = droppableUR;
                if (currentDroppable5) { 
                    
                    enterDroppable(currentDroppable5);
                }
            }
            if (currentDroppable6 != droppableUL) {
                if (currentDroppable6) { 
                    leaveDroppable(currentDroppable6);
                }
                currentDroppable6 = droppableUL;
                if (currentDroppable6) { 
                    
                    enterDroppable(currentDroppable6);
                }
            }
            if (currentDroppable7 != droppableDR) {
                if (currentDroppable7) { 
                    leaveDroppable(currentDroppable7);
                }
                currentDroppable7 = droppableDR;
                if (currentDroppable7) { 
                    
                    enterDroppable(currentDroppable7);
                }
            }
            if (currentDroppable8 != droppableDL) {
                if (currentDroppable8) { 
                    leaveDroppable(currentDroppable8);
                }
                currentDroppable8 = droppableDL;
                if (currentDroppable8) { 
                    
                    enterDroppable(currentDroppable8);
                }
            }
            if (currentDroppable1 != droppableUp) {
                if (currentDroppable1) { 
                    leaveDroppable(currentDroppable1);
                }
                currentDroppable1 = droppableUp;
                if (currentDroppable1) { 
                    
                    enterDroppable(currentDroppable1);
                }
            }
            if (currentDroppable2 != droppableDown) {
                if (currentDroppable2) { 
                    leaveDroppable(currentDroppable2);
                }
                currentDroppable2 = droppableDown;
                if (currentDroppable2) { 
                    
                    enterDroppable(currentDroppable2);
                }
            }
            if (currentDroppable3 != droppableRight) {
                if (currentDroppable3) { 
                    leaveDroppable(currentDroppable3);
                }
                currentDroppable3 = droppableRight;
                if (currentDroppable3) { 
                    
                    enterDroppable(currentDroppable3);
                }
            }
            if (currentDroppable4 != droppableLeft) {
                if (currentDroppable4) { 
                    leaveDroppable(currentDroppable4);
                }
                currentDroppable4 = droppableLeft;
                if (currentDroppable4) { 
                    
                    enterDroppable(currentDroppable4);
                }
            }
        }

        document.addEventListener('mousemove', onMouseMove);

        oskol.onmouseup = function() {
            document.removeEventListener('mousemove', onMouseMove);
            oskol.onmouseup = null;
        };

    };

    function enterDroppable(elem) {
        $(elem).attr("src","css\\icon\\lampb.svg");
        let no;
        no = $(elem).attr("id");
        $.post('.py',no);
    }

    function leaveDroppable(elem) {
        $(elem).attr('src','css\\icon\\lampw.svg');
    }

    oskol.ondragstart = function() {
        return false;
    };
</script>
</body>
</html>